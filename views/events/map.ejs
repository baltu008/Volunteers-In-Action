<% include ../partials/head %>
    <% include ../partials/header %>
        <div id="map" style="width:100%;height:100%;padding:0;"></div>
        <% include ../partials/footer %>

            <script>
                function initMap() {
                    var map = new google.maps.Map(document.getElementById('map'), {
                        zoom: 8,
                        center: {
                            lat: 44.977753,
                            lng: -93.089958
                        },
                    });
                    var geocoder = new google.maps.Geocoder();
                    // var events = ["17265 72nd Place North, Maple Grove, MN 55311",
                    //     "5630 Winnetka Ave N, Minneapolis, MN 55428", "3849 Gallagher Dr, Edina, MN 55435"
                    // ];
                    <%events.forEach(function (address) {%>
                    console.log('<%=address.location%>');
                        geocodeAddress(geocoder, map, '<%=address.location%>');
                   <%})%>
                }

                function geocodeAddress(geocoder, resultsMap, address) {
                    // var address = document.getElementById('address').value;
                    geocoder.geocode({
                        'address': address
                    }, function (results, status) {
                        if (status === 'OK') {
                            resultsMap.setCenter(results[0].geometry.location);
                            var marker = new google.maps.Marker({
                                map: resultsMap,
                                position: results[0].geometry.location
                            });
                        } else {
                            alert('Geocode was not successful for the following reason: ' + status);
                        }
                    });
                }
            </script>
            <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDOIq_BW7gCEL8VfUNdil7OLZHGAWPUjtU&callback=initMap">
            </script>